/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
(function(){"use strict";var e=[],t=o(),n=[],r,i=/\w/;function a(e,t,r,i){if(t>=0){if(r){n[e].branchTracking[t].truthy+=1}else{n[e].branchTracking[t].falsy+=1}}if(i>=0){f(e,i)}return r}function s(e,t,n){var r=parseInt(e.getAttribute(t));return r>0?r:n}function o(){var e,t=document.getElementsByTagName("script"),n,r;for(n=0,r=t.length;n<r;n+=1){e=t[n];if(/BranchTracking.js$/.test(e.getAttribute("src"))){return e}}}function c(t,r){var i=blanket.options("branchTracking"),a=false,s,o=e.length,c=t.inputFileName,u,l=t.inputFile,f;if(l.indexOf("// sap-ui-cover-browser msie")>=0){a=true;s=sap.ui.require("sap/ui/Device");if(s&&s.browser.msie){s=undefined}}e.push(c);n[o]=_$blanket[c]=[];if(i){_$blanket[c].branchTracking=[]}_$blanket[c].source=l.split("\n");_$blanket[c].source.unshift("");_$blanket[c].warnings=[];f=""+falafel(l,{attachComment:a,comment:a,loc:true,range:true,source:l},d.bind(null,i,o,s));u=f.split("\n").length+1;if(u!==_$blanket[c].source.length){h(c,"Line length mismatch! "+_$blanket[c].source.length+" vs. "+u)}r(f)}function u(e,t){if(!("$ignored"in t)){if(t.parent&&u(e,t.parent)){t.$ignored=true}else{t.$ignored=t.type==="BlockStatement"&&l(e,t)}}return t.$ignored}function l(e,t){function n(t){return t.type==="Line"&&t.value===" sap-ui-cover-browser msie"&&!(e&&e.browser.msie)}return t.body[0]&&t.body[0].leadingComments&&t.body[0].leadingComments.some(n)}function f(e,t){n[e][t]+=1}function d(e,t,r,a){var s=n[t],o=s.branchTracking,c=a.loc.start.line,f;function d(){a.update("blanket.$l("+t+", "+c+"); "+a.source());p();return true}function p(){if(c in s){h(t,"Multiple statements on same line detected"+" â€“ minified code not supported! Line number "+c)}s[c]=0}function b(){var e=a.loc.source.slice(a.left.range[1],a.right.range[0]);if(e[0]===")"){e=e.slice(1)}if(e.slice(-1)==="("){e=e.slice(0,-1)}return e}if(r&&u(r,a)){return false}switch(a.type){case"FunctionDeclaration":case"FunctionExpression":if(a.body.body[0]&&c===a.body.body[0].loc.start.line){h(t,"Function body must not start on same line! Line number "+c)}break;default:}switch(a.type){case"AssignmentExpression":case"ArrayExpression":case"BlockStatement":case"BinaryExpression":case"Block":case"CallExpression":case"CatchClause":case"DebuggerStatement":case"EmptyStatement":case"FunctionExpression":case"Identifier":case"Line":case"Literal":case"MemberExpression":case"NewExpression":case"ObjectExpression":case"Program":case"Property":case"SequenceExpression":case"SwitchCase":case"ThisExpression":case"UnaryExpression":case"UpdateExpression":case"VariableDeclarator":return false;case"ConditionalExpression":if(!e){return false}a.test.update("blanket.$b("+t+", "+o.length+", "+a.test.source()+")");o.push({alternate:a.alternate.loc,consequent:a.consequent.loc,falsy:0,truthy:0});return true;case"ExpressionStatement":if(a.expression.type==="Literal"&&a.expression.value==="use strict"){return false}case"DoWhileStatement":case"ForInStatement":case"ForStatement":case"WhileStatement":case"WithStatement":case"BreakStatement":case"ContinueStatement":case"FunctionDeclaration":case"ReturnStatement":case"SwitchStatement":case"ThrowStatement":case"TryStatement":return d(a);case"IfStatement":if(l(undefined,a.consequent)){e=false}a.test.update("blanket.$b("+t+", "+(e?o.length:-1)+", "+a.test.source()+", "+c+")");p();if(e){o.push({alternate:(a.alternate||a.test).loc,consequent:a.consequent.loc,falsy:0,truthy:0})}return true;case"LogicalExpression":if(!e){return false}if(a.operator==="||"||a.operator==="&&"){f="blanket.$b("+t+", "+o.length+", "+a.left.source()+") "+b()+" ("+a.right.source()+")";if(!i.test(a.loc.source[a.range[0]])){f=" "+f}a.update(f);o.push({alternate:a.operator==="&&"?a.left.loc:a.right.loc,consequent:a.operator==="&&"?a.right.loc:a.left.loc,falsy:0,truthy:0})}return true;case"VariableDeclaration":if(a.parent.type==="ForInStatement"||a.parent.type==="ForStatement"){return false}return d(a);case"LabeledStatement":default:throw new Error(a.source())}}function h(t,n){var r=typeof t==="string"?t:e[t];jQuery.sap.log.warning(n,r,"sap.ui.test.BranchTracking");_$blanket[r].warnings.push(n)}function p(){var e={},t=[],n;QUnit.begin(function(t){n=t.modules.length;t.modules.forEach(function(t){e[t.name]=t})});QUnit.moduleStart(function(n){t=t.concat(Object.keys(e).filter(function(t){return e[t].tests===n.tests}))});return function(){return t.length<n?t:undefined}}if(window.blanket){window._$blanket={};blanket.$b=a;blanket.$l=f;blanket.instrument=c;var b=p(),m=s(t,"data-lines-of-context",3);r=Math.min(s(t,"data-threshold",0),100);sap.ui.require(["sap/ui/test/BlanketReporter"],function(e){blanket.options("reporter",e.bind(null,m,r,b))})}var g,k="sap.ui.base.SyncPromise",y={},$,w,v=0,S,E={},x=new Map;function j(e,t){var n,r=_$blanket[e.$currentFileName],i=y[e.$currentFileName],a;if(e.$oldHits){a=Object.keys(r).filter(function(t){return!(i&&i[t])&&r[t]===e.$oldHits[t]});t.notOk(a.length,"Some lines have not been covered by this module in isolation: "+a)}if(e.$oldBranchTracking){n=Object.keys(r.branchTracking).filter(function(t){return r.branchTracking[t].falsy===e.$oldBranchTracking[t].falsy||r.branchTracking[t].truthy===e.$oldBranchTracking[t].truthy});t.notOk(n.length,"Some branches have not been fully covered by this module in isolation: "+n)}}function T(e){var t,n=Object.keys(E).length+(x?x.size:0),r="Uncaught (in promise): "+n+" times\n",i,a,s,o;if(n){for(t in E){i=E[t];if(i.getResult()&&i.getResult().stack){r+=i.getResult().stack}else{r+=i.getResult()}if(i.$error.stack){r+="\n>>> SyncPromise rejected with above reason...\n"+i.$error.stack.split("\n").slice(2).join("\n")}r+="\n\n"}E={};if(x&&x.size){o=x.values();for(;;){s=o.next();if(s.done){break}a=s.value;r+=(a&&a.stack||a)+"\n\n"}x.clear()}if(e){e(r)}else if(g){jQuery.sap.log.info("Clearing "+n+" uncaught promises",r,k)}}}if(t.getAttribute("data-uncaught-in-promise")!=="true"){window.addEventListener("unhandledrejection",function(e){if(e.reason&&e.reason.$uncaughtInPromise){return}if(x){x.set(e.promise,e.reason);e.preventDefault()}else{alert("Uncaught (in promise) "+e.reason)}});window.addEventListener("rejectionhandled",function(e){if(x){x.delete(e.promise)}})}function Q(e,t){if(t){delete E[e.$id];if(g){jQuery.sap.log.info("Promise "+e.$id+" caught",Object.keys(E),k)}return}e.$id=v++;e.$error=new Error;E[e.$id]=e;if(g){jQuery.sap.log.info("Promise "+e.$id+" rejected with "+e.getResult(),Object.keys(E),k)}}function _(e,t){var n,i,a,s;t=t||{};n=t.after||function(){};i=t.afterEach||function(){};a=t.before||function(){};s=t.beforeEach||function(){};t.after=function(e){if(window.blanket&&!$&&!S&&!this.__ignoreIsolatedCoverage__&&r>=100&&!e.test.module.stats.bad){j(this,e)}return n.apply(this,arguments)};t.afterEach=function(e){var t=T.bind(null,e.ok.bind(e,false));function n(e){t();throw e}function r(e){if(e&&typeof e.then==="function"){return e.then(r,n)}t();return e}try{return r(i.apply(this,arguments))}catch(e){n(e)}};t.before=function(e){var t;this.$currentFileName=jQuery.sap.getResourceName(e.test.module.name);t=window.blanket&&_$blanket[this.$currentFileName];if(t){this.$oldHits=t.slice();if(t.branchTracking){this.$oldBranchTracking=JSON.parse(JSON.stringify(t.branchTracking,["falsy","truthy"]))}t.warnings.forEach(function(t){e.ok(false,t)})}return a.apply(this,arguments)};t.beforeEach=function(e){T();return s.apply(this,arguments)};w(e,t)}if(QUnit.module!==_){w=QUnit.module.bind(QUnit);QUnit.module=_;sap.ui.require(["sap/base/Log","sap/base/util/UriParameters","sap/ui/base/SyncPromise"],function(e,t,n){var r=t.fromQuery(window.location.search);g=e.isLoggable(e.Level.INFO,k);$=r.get("filter");S=r.get("testId");n.listener=Q});QUnit.begin(function(){var e,t;jQuery("#qunit-modulefilter-dropdown-list").css("max-height","none");jQuery("#qunit-modulefilter-dropdown").on("click",function(e){if(e.target.tagName==="LABEL"){setTimeout(function(){jQuery("#qunit-modulefilter-actions").children().first().trigger("click")})}});if(window.blanket){for(e in _$blanket){t=_$blanket[e];y[e]=t.slice()}}});QUnit.done(function(){x=null})}})();