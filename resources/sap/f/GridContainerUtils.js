/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/Log","sap/ui/core/InvisibleRenderer","sap/ui/Device"],function(e,t,i){"use strict";return{isGridSupportedByBrowser:function(){return!i.browser.msie},findDropTargetsAbove:function(e,t){return this._findDropTargets(e,t,this._isAbove)},findDropTargetsBelow:function(e,t){return this._findDropTargets(e,t,this._isBelow)},getItemWrapper:function(e){var i=e.getDomRef(),r;if(i){return i.parentElement}r=document.getElementById(t.createInvisiblePlaceholderId(e));if(r){return r.parentElement}return null},createConfig:function(e,t){return{grid:e,item:t}},_findDropTargets:function(e,t,i){var r=[],n=this.getItemWrapper(t),o=e.getItems().filter(function(e){return i(n,this.getItemWrapper(e))}.bind(this)),s=this.createConfig(e,this._findClosest(t,o),t,i);if(s.item){r.push(s)}else{r=Array.from(document.querySelectorAll(".sapFGridContainer")).filter(function(e){return i(n,e)}).map(function(e){var r=jQuery(e).control(0);var n=this.createConfig(r,this._findClosest(t,r.getItems()),t,i);n.distFromItemToGrid=this._getDistance(t,r,i);return n}.bind(this)).sort(function(e,t){return e.distFromItemToGrid-t.distFromItemToGrid})}return r},_findClosest:function(e,t,i){var r=null,n=Number.POSITIVE_INFINITY;t.forEach(function(t){var o=this._getDistance(e,t,i);if(o<n){r=t;n=o}}.bind(this));return r},_getDistance:function(t,i,r){var n=t.getDomRef().getBoundingClientRect(),o=i.getDomRef().getBoundingClientRect();var s={x:o.left};if(r===this._isAbove){s.y=o.top+o.height}else{s.y=o.top}var u={x:s.x+o.width,y:s.y};var a={x:n.left+n.width/2,y:n.top+n.height/2};var f=(u.x-s.x)*(u.x-s.x)+(u.y-s.y)*(u.y-s.y);var c=((a.x-s.x)*(u.x-s.x)+(a.y-s.y)*(u.y-s.y))/f;var d={};if(c<0){d.x=s.x;d.y=s.y}else if(c>1){d.x=u.x;d.y=u.y}else{d.x=s.x+c*(u.x-s.x);d.y=s.y+c*(u.y-s.y)}var g=d.x-a.x,l=d.y-a.y,p=g*g+l*l;if(p>Number.MAX_SAFE_INTEGER){e.warning("Maximum safe integer value exceeded.",p,"GridContainerUtils")}return p},_isAbove:function(e,t){var i=e.getBoundingClientRect().top,r=t.getBoundingClientRect().top;return r-i<0},_isBelow:function(e,t){var i=e.getBoundingClientRect().top,r=t.getBoundingClientRect().top;return r-i>0}}});